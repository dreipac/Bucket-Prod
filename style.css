/* ---------- Base & Variables ---------- */
* { box-sizing: border-box; }
html, body { height: 100%; }

:root{
  --glass-rgb: 22 24 28;
  --glass-alpha: .58;
  --glass-strong-alpha: .75;
  --card-alpha: .82;

  --accent: #22b0ff;
  --accent-2: #7c4dff;

  --ink: #e9eef6;
  --ink-strong: #fff;
  --ink-inverse: #0b1220;
  --muted: #b9c0c9;

  --success: #2ecc71;
  --danger: #ff6b6b;

  --radius: 18px;
  --shadow: 0 12px 36px rgba(0,0,0,.4);

  --bg: #101317;
  --overlay-dark: .55;
  --overlay-light: .18;
}

/* Dark/Light */
html[data-theme="dark"]{
  --glass-rgb: 22 24 28;
  --ink: #e9eef6; --ink-strong:#fff; --ink-inverse:#0b1220; --bg:#101317;
}
html[data-theme="light"]{
  --glass-rgb: 255 255 255;
  --ink: #0b1220; --ink-strong:#0b1220; --ink-inverse:#e9eef6; --bg:#f6f8fb;
}

body{
  margin: 0; color: var(--ink);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
}
body::before{
  content:""; position:fixed; inset:0; z-index:-1;
  background:
    radial-gradient(60% 80% at 10% 0%, color-mix(in srgb, var(--accent) 30%, transparent), transparent 60%),
    radial-gradient(80% 60% at 100% 100%, color-mix(in srgb, var(--accent-2) 30%, transparent), transparent 60%),
    linear-gradient(rgba(10,12,15, var(--overlay-dark)), rgba(10,12,15, var(--overlay-dark))),
    var(--bg-url, url("background/zurich.png")) center/cover no-repeat fixed;

  filter: saturate(1.05);
}
html[data-theme="light"] body::before{
  background:
    radial-gradient(60% 80% at 10% 0%, color-mix(in srgb, var(--accent) 18%, transparent), transparent 60%),
    radial-gradient(80% 60% at 100% 100%, color-mix(in srgb, var(--accent-2) 18%, transparent), transparent 60%),
    linear-gradient(rgba(255,255,255, var(--overlay-light)), rgba(255,255,255, var(--overlay-light))),
    var(--bg-url, url("background/zurich.png")) center/cover no-repeat fixed;

}

/* ==== Galaxy Blue Theme ==== */
html[data-theme="galaxy"]{
  /* Snapchat-Plus-Blau als Akzent */
  --accent: #0EA5FF;          /* primäres Blau */
  --accent-ink: #ffffff;      /* Text auf Akzent */
  --ink: #E7F6FF;             /* Primärtext */
  --ink-dim: #B6E1FF;         /* gedimmter Text */
  --surface: rgba(8,16,28,0.55);
  --glass-rgb: 10 30 60;      /* Glass-Look Blau */
  --card: rgba(10, 22, 45, 0.55);
  --border: rgba(14,165,255,0.22);
  background-color: #050A14;
}

/* sanfter Nebula-Glow über dem Hintergrundbild (durch Canvas ergänzt) */
html[data-theme="galaxy"] body{
  background-blend-mode: overlay;
}

/* ==== Galaxy Canvas Overlay ==== */
#galaxyCanvas{
  position: fixed;
  inset: 0;
  z-index: -1;              /* unter dem UI, über dem Body-Bg */
  pointer-events: none;
  opacity: 0;               /* nur im Galaxy-Modus sichtbar */
  transition: opacity .4s ease;
}
html[data-theme="galaxy"] #galaxyCanvas{ opacity: 1; }


.glass{ background: rgb(var(--glass-rgb) / var(--glass-strong-alpha)); backdrop-filter: blur(10px); box-shadow: var(--shadow); border-radius: var(--radius); }

/* ---------- Topbar ---------- */
.topbar{ display:flex; align-items:center; gap:12px; padding:10px 16px; margin:18px; }
.topbar h1{ font-size:22px; margin:0; }
.topbar .topbar-actions{ margin-left:auto; display:flex; align-items:center; gap:10px; }
.icon-btn{ width:40px;height:40px;border-radius:12px;border:0;cursor:pointer;background:#3a3d42;color:#fff;display:grid;place-items:center; }
html[data-theme="light"] .icon-btn{ background:#e1e5ec; color:#0b1220; }
.burger, .burger::before, .burger::after{ content:""; display:block; width:18px; height:2px; background:currentColor; border-radius:2px; position:relative; }
.burger::before{ position:absolute; transform: translateY(-6px); }
.burger::after{ position:absolute; transform: translateY(6px); }

/* ---------- Layout ---------- */
.layout{ display:grid; grid-template-columns:auto 1fr; gap:18px; padding:0 18px 18px; }
.sidebar{ padding:16px; min-height:calc(100vh - 140px); }
.content{ padding:18px; min-height:calc(100vh - 140px); background: rgb(var(--glass-rgb) / var(--glass-alpha)); border-radius: var(--radius); box-shadow: var(--shadow); }

/* ---------- Add list ---------- */
.list-add{ display:flex; gap:10px; align-items:center; margin-bottom:14px; }
.list-add input{ flex:1; padding:12px 14px; border-radius:14px; border:0; background:#2b2f35; color:#fff; outline:none; }
html[data-theme="light"] .list-add input{ background:#eef1f6; color:#0b1220; }
.pill{ border-radius:14px; padding:10px 14px; border:0; cursor:pointer; font-weight:700; }
.pill-primary{ background: var(--accent); color: var(--ink-inverse); }

/* ---------- Lists ---------- */
.lists{ display:flex; flex-direction:column; gap:10px; margin-top:10px;}
.list-row{ display:grid; grid-template-columns: 1fr auto 28px; align-items:center; gap:8px; }
.list-btn{
  width:100%; text-align:left; border:0; cursor:pointer; padding:14px 16px; border-radius:16px;
  color:var(--ink); background:#1b1f25; transition: transform .06s ease, background .2s ease, outline .2s; border:1px solid rgba(255,255,255,.05);
}
.list-btn:hover{ background:#262b33; }
.list-btn.active{
  background:#0e1117;
  outline:2px solid transparent;
  background-image: linear-gradient(#0e1117,#0e1117), linear-gradient(135deg, var(--accent), var(--accent-2));
  background-origin:border-box; background-clip: padding-box, border-box;
}
html[data-theme="light"] .list-btn{ background:#f1f4f9; color:#0b1220; border-color: rgba(0,0,0,.06); }
html[data-theme="light"] .list-btn:hover{ background:#e8ecf5; }
html[data-theme="light"] .list-btn.active{ background:#fff; }

.list-actions{ display:flex; gap:6px; opacity:0; transition:opacity .15s ease; }
.list-row:hover .list-actions{ opacity:1; }
.icon.xsmall{ background:#2b2f35; color:#fff; border:0; border-radius:10px; padding:6px 8px; cursor:pointer; }
.icon.xsmall:hover{ background:#373d45; }
html[data-theme="light"] .icon.xsmall{ background:#e1e6ee; color:#0b1220; }
html[data-theme="light"] .icon.xsmall:hover{ background:#d6dde9; }

.drag-handle.list{ background: transparent; color:#c9d2dc; border:0; cursor: grab; font-size:18px; line-height:1; padding:2px 0 0; user-select:none; }
.drag-handle.list:active{ cursor: grabbing; }
html[data-theme="light"] .drag-handle.list{ color:#536072; }

.list-row.dragging{ opacity:.7; transform: scale(.98); }
.list-drop-marker{ height:8px; margin:4px 0; border-radius:999px; background: linear-gradient(90deg,var(--accent),var(--accent-2)); }
.list-row.drop-target .list-btn{ outline:2px dashed var(--accent); }

/* ---------- Buttons "pop" (mit variabler Dauer) ---------- */
:root{
  /* Basisdauer für Button-Press-Animation – wird von JS überschrieben */
  --press-dur: 220ms;
}

.pressable{
  will-change: transform, filter;
  transition:
    transform var(--press-dur) cubic-bezier(.22,1,.36,1),
    filter    var(--press-dur) ease,
    box-shadow var(--press-dur) ease;
}

/* Bounce nach dem Loslassen: leicht über 1 skalieren, dann auf 1 zurück */
.pressable.pop{
  animation: press-pop var(--press-dur) ease-out;
}
@keyframes press-pop{
  0%   { transform: scale(.965); }
  60%  { transform: scale(1.035); }
  100% { transform: scale(1); }
}

/* ---------- Content Top (Filters) ---------- */
.content-top{ display:flex; align-items:center; gap:12px; margin-bottom:14px; flex-wrap: wrap; }
.filters{ display:flex; align-items:center; gap:8px; margin-left:auto; }
.filters input[type="search"], .filters select{
  background:#1b1f25; color:var(--ink); border:1px solid rgba(255,255,255,.08);
  border-radius:12px; padding:10px 12px; outline:none; min-height:40px;
}
html[data-theme="light"] .filters input[type="search"], html[data-theme="light"] .filters select{
  background:#f1f4f9; color:#0b1220; border-color: rgba(0,0,0,.06);
}

/* ---------- Progress + smooth ---------- */
.progress-wrap{ display:grid; grid-template-columns: 1fr auto; align-items:center; gap:12px; margin: 6px 0 12px; }
.progress{ height:10px; border-radius:999px; background: rgb(var(--glass-rgb) / .35); overflow:hidden; }
.progress-bar{
  height:100%; width:0%;
  transition: width 500ms cubic-bezier(.22,1,.36,1), background-position 800ms linear;
  will-change: width, background-position;
  background-image:
    linear-gradient(90deg, var(--accent), var(--accent-2)),
    repeating-linear-gradient(-45deg, rgba(255,255,255,.18) 0 10px, rgba(255,255,255,0) 10px 20px);
  background-size: 200% 100%, 18px 18px; background-position: 0 0, 0 0;
}
.progress-bar.moving{ background-position: 100% 0, 40px 0; }
.progress-text{ font-size:13px; color: var(--muted); }

/* ---------- Items ---------- */
.items{ list-style:none; margin:10px 0 0; padding:0; display:flex; flex-direction:column; gap:12px; }
.items.drag-active{ outline:2px dashed var(--accent); outline-offset:6px; border-radius:16px; }

.card{
  position:relative; border-radius:28px; border:1px solid transparent;
  background:
    linear-gradient(rgb(var(--glass-rgb) / var(--card-alpha)), rgb(var(--glass-rgb) / var(--card-alpha))) padding-box,
    linear-gradient(135deg, color-mix(in srgb, var(--accent) 55%, transparent), color-mix(in srgb, var(--accent-2) 55%, transparent)) border-box;
}

.item{
  display: grid;
  grid-template-columns: 44px 1fr auto 28px; /* vorher 36px */
  align-items: flex-start;
  gap: 12px;
  padding: 14px;
  transform-origin: 50% 0%;
}

.item.anim-in{ animation:itemIn .18s ease-out both; }
.item.anim-out{ animation:itemOut .16s ease-in forwards; }
@keyframes itemIn{ 0%{ opacity:0; transform: scale(.94); } 70%{ opacity:1; transform: scale(1.02); } 100%{ opacity:1; transform: scale(1); } }
@keyframes itemOut{ from{ opacity:1; transform: scale(1); } to{ opacity:0; transform: scale(.85); } }

.item .row1{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
.item .title{ font-size:16px; font-weight:700; }
.item .notes{ color:#cdd3db; opacity:.9; margin:6px 0 0; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
html[data-theme="light"] .item .notes{ color:#425162; }
.item.done .title{ text-decoration: line-through; color: #9aa3ad; opacity:.9; }
.item.done{ opacity:.85; }

/* ---------- Runde, größere Checkbox mittig links ---------- */
.checkbox{
  position: relative;
  width: 28px;
  height: 28px;
  display: grid;
  place-items: center;
  margin: 0;
  align-self: center;               /* vertikal mittig in der Item-Zeile */
}
.checkbox input{
  opacity: 0;
  position: absolute;
  inset: 0;
  margin: 0;
  cursor: pointer;
}
.checkbox .checkmark{
  position: relative;
  width: 20px;
  height: 20px;
  border-radius: 50%;               /* rund */
  border: 2px solid #758192;        /* neutraler Rand */
  background: transparent;
  display: block;
  transition:
    background .18s ease,
    border-color .18s ease,
    transform .08s ease;
}

/* Weißer Haken – erscheint/animiert im aktiven Zustand */
.checkbox .checkmark::after{
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  width: 10px;
  height: 6px;
  border: 2px solid #fff;
  border-top: 0;
  border-right: 0;
  transform: translate(-50%, -50%) rotate(-45deg) scale(.8);
  opacity: 0;
  transition:
    opacity .14s ease .05s,
    transform .18s cubic-bezier(.22,1,.36,1) .05s;
}

/* Aktiv: grün gefüllt, Haken sichtbar */
.item input:checked + .checkmark{
  background: var(--success);
  border-color: var(--success);
}
.item input:checked + .checkmark::after{
  opacity: 1;
  transform: translate(-50%, -50%) rotate(-45deg) scale(1);
}

/* Hover/Focus-Feedback & Light-Theme-Randfarbe */
.checkbox .checkmark:hover{ transform: scale(1.02); }
.checkbox input:focus-visible + .checkmark{
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 35%, transparent);
  border-color: var(--accent);
}
html[data-theme="light"] .checkbox .checkmark{ border-color:#9aa6b5; }


.chip{ display:inline-flex; align-items:center; gap:6px; background:#26303a; color:#d8e2ee; border-radius:999px; padding:6px 10px; font-size:12px; border:1px solid rgba(255,255,255,.08); }
html[data-theme="light"] .chip{ background:#e8eef6; color:#0b1220; border-color: rgba(0,0,0,.06); }
.chip.overdue{ color:#fff; background:#3b2227; border-color:#542d33; }
.chip.done{ background:#22352a; color:#aaf0c8; }

/* Prioritäts-Badges */
.prio.low{ background:#1e2d24; color:#baf2cf; border-color:#254934; }
.prio.med{ background:#2a2733; color:#e6d6ff; border-color:#3b3550; }
.prio.high{ background:#3b2227; color:#ffd4d4; border-color:#5a2e35; }
html[data-theme="light"] .prio.low{ background:#e8f7ef; color:#134d2a; border-color:#cdeede; }
html[data-theme="light"] .prio.med{ background:#efe9ff; color:#3d2b6b; border-color:#e3d9ff; }
html[data-theme="light"] .prio.high{ background:#ffe9ea; color:#7a1e2a; border-color:#ffd3d6; }

.item-actions{ display:flex; gap:6px; }
.icon.small{ background:#2b2f35; color:#fff; border:0; border-radius:12px; padding:8px 10px; cursor:pointer; transition: background .15s ease, transform .05s ease; }
.icon.small:hover{ background:#353a41; }
.icon.small:active{ transform: translateY(1px); }
.icon.small[data-action="delete"]:hover{ background:#3b2227; color:#ffb0b0; }
html[data-theme="light"] .icon.small{ background:#e1e6ee; color:#0b1220; }
html[data-theme="light"] .icon.small:hover{ background:#d6dde9; }
html[data-theme="light"] .icon.small[data-action="delete"]:hover{ background:#ffe3e3; color:#8b0000; }

.drag-handle{ background: transparent; color:#c9d2dc; border:0; cursor: grab; font-size:18px; line-height:1; padding:2px 0 0; user-select:none; }
.drag-handle:active{ cursor: grabbing; }
html[data-theme="light"] .drag-handle{ color:#536072; }

.item.dragging{ opacity:.6; transform: scale(.98); }
.drop-marker{ height:10px; margin:4px 0; border-radius:999px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); }

/* ---------- Drawer ---------- */
/* Drawer sichtbar während der Schließ-Animation */
.drawer.open,
.drawer.closing { pointer-events:auto; visibility:visible; }

/* Während closing: rückwärts animieren */
.drawer.closing .drawer-backdrop { opacity: 0; }
.drawer.closing .drawer-panel { transform: translateX(-100%); }
.drawer{ position:fixed; inset:0; pointer-events:none; visibility:hidden; }
.drawer.open{ pointer-events:auto; visibility:visible; }
.drawer-backdrop{ position:absolute; inset:0; background: rgba(0,0,0,.55); backdrop-filter: blur(2px); opacity: 0; transition: opacity .28s cubic-bezier(.22,1,.36,1); }
.drawer.open .drawer-backdrop{ opacity:1; }
.drawer-panel{
  position:absolute; left:0; top:0; bottom:0; width:min(320px, 92vw);
  padding:16px; transform: translateX(-100%);
  background: rgb(var(--glass-rgb) / var(--glass-strong-alpha)); backdrop-filter: blur(12px);
  box-shadow: 0 0 0 1px rgba(255,255,255,.06), 0 24px 48px rgba(0,0,0,.45);
  transition: transform .28s cubic-bezier(.22,1,.36,1);
}
.drawer.open .drawer-panel{ transform: translateX(0); }
.drawer-panel h3{ margin:6px 0 10px; }
.drawer-nav{ display:flex; flex-direction:column; gap:8px; }
.drawer-link{ align-items: center; gap: 8px; display: flex; text-align:left;  border:0; border-radius:12px; padding:12px 14px; cursor:pointer; background:#1b1f25; color:var(--ink); }
.drawer-link .btn-drawer-text {font-weight: bold;}
.drawer-link:hover{ background:#262b33; }
html[data-theme="light"] .drawer-link{ background:#f1f4f9; color:#0b1220; }
html[data-theme="light"] .drawer-link:hover{ background:#e8ecf5; }

/* ---------- Modal (shared) ---------- */
.modal{
  position: fixed;
  inset: 0;
  visibility: hidden;          /* statt display:none -> erlaubt Ausblend-Animation */
  pointer-events: none;
  z-index: 100;
}

/* Offen: klickbar */
.modal.open{
  visibility: visible;
  pointer-events: auto;
}

/* Schließen-Phase: sichtbar (für die Out-Animation), aber klicktransparent */
.modal.closing{
  visibility: visible;
  pointer-events: none;
}

/* Explizit versteckt: niemals blockieren */
.modal[aria-hidden="true"]{
  visibility: hidden !important;
  pointer-events: none !important;
}

.modal-backdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(2px);
  opacity: 0;                   /* Startzustand für Fades */
  transition: opacity .22s cubic-bezier(.22,1,.36,1);
}

/* Wenn Modal versteckt ist, darf nichts klicken/scrollen blockieren */
.modal[aria-hidden="true"] {
  pointer-events: none;
}

.modal[aria-hidden="true"] .modal-backdrop {
  opacity: 0;
  pointer-events: none;
}


.modal.open .modal-backdrop{ opacity: 1; }
.modal.closing .modal-backdrop{ opacity: 0; }

/* Deine bestehende Zentrierung/Grösse bitte beibehalten */
.modal-dialog{
  position:absolute; left:50%; top:50%;
  transform:translate(-50%,-50%);
  width:min(760px, 94vw);
  padding:22px;
}
/* ==== Item-Modal: Scrollbarer Body + sticky Actions ==== */
#itemModal .modal-dialog{
  /* Begrenze die Gesamthöhe des Dialogs */
  max-height: min(86vh, 92svh);
  display: flex;
  flex-direction: column;
  min-height: 0; /* wichtig, damit das Kind scrollen darf */
}

/* Das Formular selbst wird die Scroll-Container-Fläche */
#itemForm{
  display: flex;
  flex-direction: column;
  min-height: 0;       /* verhindert, dass der Inhalt "zu groß" wird */
  overflow: auto;      /* -> hier scrollt’s bei Bedarf */
  gap: 0;              /* opt. – konsistente Abstände */
  padding-bottom: 12px;/* Luft unterhalb des Inhalts */
}

/* Die Button-Leiste bleibt immer sichtbar */
#itemForm .modal-actions{
  position: sticky;
  bottom: -22px; /* kompensiert das Padding der .modal-dialog (22px) */
  margin-top: 12px;
  z-index: 2;

  /* dezente Trennung + Glas-Hintergrund für Lesbarkeit beim Scrollen */
  padding-top: 10px;
  background:
    linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,.12) 32%),
    rgb(var(--glass-rgb) / var(--glass-strong-alpha));
  backdrop-filter: blur(10px);
  border-top: 1px solid rgba(255,255,255,.08);
}

/* Light-Theme Feinschliff für die klebende Fußleiste */
html[data-theme="light"] #itemForm .modal-actions{
  background:
    linear-gradient(to bottom, rgba(255,255,255,0), rgba(0,0,0,.06) 28%),
    #ffffff;
  border-top-color: rgba(0,0,0,.08);
}
/* Optional: sanfte Absetzung der Subtasks vom Footer beim Scrollen */
#subtasksContainer{
  padding-bottom: 8px;
}

#itemForm h2, #settingsForm h2{ margin: 6px 0 10px; font-size:28px; }
.field{ display:flex; flex-direction:column; gap:8px; margin:14px 0; }
.label{ color:#d5dbe3; font-size:14px; }
html[data-theme="light"] .label{ color:#38455b; }
#fTitle{ background: transparent; border:0; border-bottom:1px solid #5c6169; padding:10px 4px; color:var(--ink); }
/* weiche Animation */
#fTitle{ transition: border-color .2s ease; }

/* Fokus-Style: Linie in Akzentfarbe */
#fTitle:focus,
#fTitle:focus-visible{
  outline: none;
  border-bottom-color: var(--accent);
}

/* Notizen: gleicher Fokus-Rand wie beim Titel */
#fNotes{
  /* Grundlinie wie beim Titel, aber als Vollrand */
  border: 1px solid #5c6169;
  /* weiche Farbtransition wie beim Titel */
  transition: border-color .2s ease;
  /* (Textarea-Hintergrund behält die bestehenden Regeln) */
}

#fNotes:focus,
#fNotes:focus-visible{
  outline: none;
  border-color: var(--accent);
}

html[data-theme="light"] #fNotes{
  border-color: #c2c9d6;
}


html[data-theme="light"] #fTitle{ border-bottom-color:#c2c9d6; }
.row{ display:flex; align-items:center; gap:12px; margin:14px 0; }
.row-inputs{ display:flex; gap:12px; }
textarea{ width:100%; resize:vertical; min-height:140px; border:0; border-radius:14px; background:#2b2b2b; color:#fff; padding:12px; }
textarea:active {box-shadow: white;}
html[data-theme="light"] textarea{ background:#eef1f6; color:#0b1220; }

.settings .settings-section{ margin: 14px 0 18px; }
.range-row{ display:flex; align-items:center; gap:12px; }
/* === Settings: Range Sliders (modern & filled) === */
.field input[type="range"]{
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 14px;                          /* Klickfläche */
  background:
    linear-gradient(var(--accent) 0 0) 0/var(--val,0%) 100% no-repeat,   /* Füllstand */
    linear-gradient(90deg, rgba(255,255,255,.10), rgba(255,255,255,.06));/* Rest */
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.18);
  outline: none;
  cursor: pointer;
  transition: box-shadow .18s ease, filter .18s ease, background-size .18s ease, border-color .18s ease;
}

.field input[type="range"]:hover{
  box-shadow: 0 8px 20px rgba(0,0,0,.22) inset;
}
.field input[type="range"]:focus-visible{
  border-color: var(--accent);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 32%, transparent);
}

/* WebKit Track/Thumb */
.field input[type="range"]::-webkit-slider-runnable-track{
  height: 8px;
  background: transparent;
  border: 0;
  border-radius: 999px;
}
.field input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance: none;
  appearance: none;
  width: 18px; height: 18px;
  margin-top: -5px;                      /* zentriert auf 8px Track */
  border-radius: 50%;
  background: #fff;
  border: 2px solid var(--accent);
  box-shadow:
    0 2px 10px rgba(0,0,0,.25),
    0 0 0 6px color-mix(in srgb, var(--accent) 18%, transparent);
  transition: transform .12s ease, box-shadow .18s ease, filter .18s ease;
}
.field input[type="range"]::-webkit-slider-thumb:hover{
  transform: scale(1.06);
}
.field input[type="range"]::-webkit-slider-thumb:active{
  transform: scale(0.98);
  box-shadow:
    0 1px 6px rgba(0,0,0,.25),
    0 0 0 10px color-mix(in srgb, var(--accent) 28%, transparent);
}

/* Firefox Track/Thumb */
.field input[type="range"]::-moz-range-track{
  height: 8px;
  background: transparent;
  border: 0;
  border-radius: 999px;
}
.field input[type="range"]::-moz-range-progress{
  height: 8px;
  background: var(--accent);
  border-radius: 999px 0 0 999px;
}
.field input[type="range"]::-moz-range-thumb{
  width: 18px; height: 18px;
  border-radius: 50%;
  background: #fff;
  border: 2px solid var(--accent);
  box-shadow:
    0 2px 10px rgba(0,0,0,.25),
    0 0 0 6px color-mix(in srgb, var(--accent) 18%, transparent);
  transition: transform .12s ease, box-shadow .18s ease, filter .18s ease;
}
.field input[type="range"]::-moz-range-thumb:hover{ transform: scale(1.06); }
.field input[type="range"]::-moz-range-thumb:active{
  transform: scale(0.98);
  box-shadow:
    0 1px 6px rgba(0,0,0,.25),
    0 0 0 10px color-mix(in srgb, var(--accent) 28%, transparent);
}

/* Light-Theme Feinschliff */
html[data-theme="light"] .field input[type="range"]{
  border-color: rgba(0,0,0,.12);
  background:
    linear-gradient(var(--accent) 0 0) 0/var(--val,0%) 100% no-repeat,
    linear-gradient(90deg, rgba(0,0,0,.06), rgba(0,0,0,.03));
}
html[data-theme="light"] .field input[type="range"]::-webkit-slider-thumb{
  background:#ffffff; border-color: var(--accent);
}
html[data-theme="light"] .field input[type="range"]::-moz-range-thumb{
  background:#ffffff; border-color: var(--accent);
}

.range-value{ min-width:48px; text-align:right; font-variant-numeric: tabular-nums; }
.hint{ color:#b9c0c9; }
html[data-theme="light"] .hint{ color:#6b7787; }

.theme-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); gap:10px; margin-top:8px; }
.theme-swatch{
  display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.08);
  background:#1b1f25; color:var(--ink); cursor:pointer;
}

/* === Farbschema-Kacheln: Hover & Click === */
.theme-swatch{
  position: relative;           /* für Ripple */
  overflow: hidden;             /* Ripple begrenzen */
  transform: translateY(0) scale(1);
  transition: transform .16s ease, filter .16s ease, box-shadow .16s ease;
}
.theme-swatch:hover{
  transform: translateY(-1px) scale(1.02);
  filter: brightness(1.04);
}
.theme-swatch:active{
  transform: translateY(0) scale(.98);
}

/* kleiner „Glow“ wenn ausgewählt + geklickt */
.theme-swatch.clicked{
  box-shadow: 0 0 0 2px var(--accent) inset, 0 8px 24px rgba(0,0,0,.25);
}

.theme-swatch span{ display:inline-block; width:20px; height:20px; border-radius:999px; box-shadow: inset 0 0 0 2px rgba(255,255,255,.15); }
.theme-swatch.selected{ outline:2px solid var(--accent); background:#0e1117; }
html[data-theme="light"] .theme-swatch{ background:#f1f4f9; border-color: rgba(0,0,0,.06); color:#0b1220; }
html[data-theme="light"] .theme-swatch.selected{ background:#fff; }

/* Segmented control (Dark/Light/Prio) — klar als Schalter erkennbar */
.segmented{
  display:inline-flex;
  gap:6px;
  padding:6px;
  border-radius:12px;
  background: rgb(var(--glass-rgb)/.35);
}

.seg-btn{
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);           /* inaktiv = echtes Feld */
  color: var(--ink);
  padding:8px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  transition: background .18s ease, color .18s ease, transform .18s ease, box-shadow .18s ease, border-color .18s ease;
  min-width: 96px;                              /* wirkt wie Schalterfläche */
  text-align:center;
}

/* Hover/Press (inaktiv) */
.seg-btn:hover{
  background: rgba(255,255,255,.12);
  box-shadow: 0 6px 18px rgba(0,0,0,.18) inset;
}
.seg-btn:active{
  transform: scale(.98);
}

/* Aktiv = dein Gradient + invertierter Text, Rahmen ausblenden */
.seg-btn[aria-pressed="true"],
.seg-btn.active{
  background: linear-gradient(180deg, var(--accent-2), var(--accent));
  color: var(--ink-inverse);
  border-color: transparent;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.08);
}

/* Speziell für den „Darstellung“-Block (#modeSegment): sanftere Interaktion */
#modeSegment .seg-btn{
  position: relative;    /* für Ripple */
  overflow: hidden;
}

/* Ripple für Klickfeedback */
.seg-btn .ripple{
  position: absolute;
  width: var(--rs, 20px);
  height: var(--rs, 20px);
  left: var(--rx, 0);
  top: var(--ry, 0);
  border-radius: 999px;
  background: currentColor;
  opacity: .22;
  transform: scale(0);
  pointer-events: none;
  animation: ripple-enter .5s ease-out forwards;
}
@keyframes ripple-enter{ to { transform: scale(1); opacity: 0; } }

/* Fokus sichtbar halten */
.seg-btn:focus-visible{
  outline:2px solid var(--accent);
  outline-offset:2px;
}

/* Light-Theme-Kontraste */
html[data-theme="light"] .seg-btn{
  background: rgba(0,0,0,.04);
  border-color: rgba(0,0,0,.16);
  color: #0b1220;
}
html[data-theme="light"] .seg-btn:hover{
  background: rgba(0,0,0,.06);
}


/* ----- Buttons global ----- */
.btn{ border:0; border-radius:14px; padding:12px 16px; cursor:pointer; font-weight:700; line-height:1; transition: transform .05s ease, filter .15s ease, background .15s ease; user-select:none; }
.btn:focus-visible{ outline:2px solid var(--accent); outline-offset:2px; }
.btn:disabled{ opacity:.6; cursor:not-allowed; }
.btn-primary{ color: var(--ink-inverse); background: linear-gradient(180deg, var(--accent-2), var(--accent)); box-shadow: 0 6px 16px color-mix(in srgb, var(--accent) 35%, transparent); }
.btn-primary:hover{ filter: brightness(1.03); }
.btn-muted{ background:#5b636d; color:#fff; }
.btn-muted:hover{ filter: brightness(1.05); }
html[data-theme="light"] .btn-muted{ background:#ccd3df; color:#0b1220; }
.modal-actions{ display:flex; justify-content:flex-end; gap:10px; margin-top:16px; }

/* ----- Fancy Select / Filter Dropdowns ----- */
.visually-hidden{ position:absolute !important; width:1px !important; height:1px !important; padding:0 !important; margin:-1px !important; overflow:hidden !important; clip:rect(0 0 0 0) !important; white-space:nowrap !important; border:0 !important; }
.fs{ position:relative; display:inline-block; }
.fs-btn{ display:flex; align-items:center; gap:8px; min-height:40px; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background:#1b1f25; color:var(--ink); cursor:pointer; transition: filter .15s ease, background-color .15s ease, border-color .15s ease; }
.fs-btn:hover{ filter:brightness(1.04); }
.fs-btn:focus-visible{ outline:2px solid var(--accent); outline-offset:2px; }
.fs .chev{ width:14px; height:14px; margin-left:4px; transition: transform .18s ease; }
.fs.open .chev{ transform: rotate(180deg); }
.fs-menu{ position:absolute; top:calc(100% + 6px); left:0; right:0; z-index:999; padding:6px; margin:0; list-style:none; background: rgb(var(--glass-rgb) / var(--glass-strong-alpha)); border:1px solid rgba(255,255,255,.08); border-radius:14px; box-shadow: 0 20px 50px rgba(0,0,0,.45); opacity:0; transform: translateY(-4px) scale(.98); pointer-events:none; transition: opacity .16s ease, transform .16s ease; backdrop-filter: blur(10px); }
.fs.open .fs-menu{ opacity:1; transform: translateY(0) scale(1); pointer-events:auto; }
.fs-menu li{ padding:10px 10px; border-radius:10px; cursor:pointer; color:var(--ink); }
.fs-menu li:hover, .fs-menu li:focus{ background:#262b33; outline: none; }
.fs-menu li.selected{ outline:2px solid var(--accent); outline-offset:-2px; background:#1b1f25; }
html[data-theme="light"] .fs-btn{ background:#f1f4f9; color:#0b1220; border-color: rgba(0,0,0,.06); }
html[data-theme="light"] .fs-menu{ background:#fff; border-color: rgba(0,0,0,.08); }
html[data-theme="light"] .fs-menu li:hover, html[data-theme="light"] .fs-menu li:focus{ background:#eef2f8; }

/* ----- Smooth List Switch ----- */
.list-switchable{ will-change: opacity, transform, filter; }
.list-switch-out{ opacity: 0; transform: translateY(8px) scale(.98); filter: blur(2px); transition: opacity .18s ease, transform .18s ease, filter .18s ease; }
.list-switch-in{ animation: listSwitchIn .24s cubic-bezier(.22,1,.36,1) both; }
@keyframes listSwitchIn{ from{ opacity:0; transform: translateY(8px) scale(.98); filter: blur(2px); } to{ opacity:1; transform: none; filter: none; } }

/* ===== Aktive Filter/Suche hervorheben ===== */
.filters .fs.active .fs-btn{
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--accent) inset;
}

.filters input[type="search"].is-active{
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--accent) inset;
}

/* Sidebar-Tools: Backup/Restore (Design bleibt gleich) */
.side-tools{
  margin-top: 14px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;

}
.side-tools .icon.xsmall{
  width: auto; /* nicht quetschen */
  align-items: center;
  text-align: left;
}

/* ===== Celebrate + Confetti ===== */
.item.flash{
  animation: flashGlow .6s ease-out both;
}
@keyframes flashGlow{
  0%{ box-shadow: 0 0 0 rgba(0,0,0,0); transform: scale(1); }
  30%{ box-shadow: 0 0 24px color-mix(in srgb, var(--accent) 60%, transparent); transform: scale(1.02); }
  100%{ box-shadow: 0 0 0 rgba(0,0,0,0); transform: scale(1); }
}

.confetti{
  position:absolute; inset:0; pointer-events:none; overflow:visible;
}
.confetti i{
  position:absolute; left:50%; top:50%;
  width:6px; height:10px; border-radius:1px;
  opacity:0; transform: translate(-50%, -50%) scale(.8) rotate(0deg);
  animation: confettiFly 700ms ease-out forwards;
}
@keyframes confettiFly{
  0%  { opacity:0; transform: translate(-50%, -50%) scale(.8) rotate(0deg); }
  10% { opacity:1; }
  100%{
    opacity:0;
    transform:
      translate(calc(-50% + var(--tx)), calc(-50% + var(--ty)))
      scale(1) rotate(var(--rot));
  }
}

/* ===== Layout-Variablen ===== */
:root{
  --sidebar-w: 280px;   /* Startbreite */
  --card-scale: 1;      /* 0.85 – 1.35 */
  --pages-w: 360px;
}

/* Sidebar nutzt Variable */
#sidebar{ width: var(--sidebar-w); }

/* Vertikaler Splitter (zum Ziehen) */
.v-splitter{
  position: fixed;
  left: calc(var(--sidebar-w) - 4px); /* leicht überlappen */
  top: var(--topbar-h, 64px);         /* falls nicht gesetzt -> 64px */
  bottom: 0;
  width: 8px;
  cursor: ew-resize;
  z-index: 30;
  background: transparent;
}
.v-splitter::after{
  content:"";
  position:absolute; inset:0;
  border-left:1px solid rgba(255,255,255,.06);
  border-right:1px solid rgba(0,0,0,.2);
  opacity:0; transition: opacity .2s;
}
.v-splitter:hover::after,
.v-splitter.dragging::after{ opacity:1; }

/* ===== Skalierung: Karten & Listenreihen ===== */
/* Vorsichtig dosiert: nur Karten/Einträge + Listenzeilen, nicht alles globale */
.item{
  font-size: calc(1rem * var(--card-scale));
  padding: calc(12px * var(--card-scale)) calc(14px * var(--card-scale));
}
.item .title{ font-weight: 600; }
.lists .list-btn,
.list-row .list-btn{
  font-size: calc(1rem * (0.94 + (var(--card-scale) - 1)*0.8)); /* leicht anpassen */
}

/* Optional: Abstände zwischen Karten sanft mitskalieren */
#items{ gap: calc(10px * var(--card-scale)); }


/* ===== Hover-Effekt für Einträge (sanftes Vergrößern) ===== */
.items .item.card{
  /* weiches Ein-/Ausblenden der Bewegung */
  transition: transform .16s cubic-bezier(.22,1,.36,1), box-shadow .16s ease, background-color .16s ease;
  will-change: transform;
}

/* Hover mit Maus */
.items .item.card:hover{
  transform: scale(1.02);
  z-index: 2; /* über Nachbarn heben, damit nichts abgeschnitten wird */
  box-shadow: 0 12px 36px rgba(0,0,0,.40);
}

/* Auch per Tastaturfokus (z. B. Tab in Buttons innerhalb des Items) */
.items .item.card:focus-within{
  transform: scale(1.02);
  z-index: 2;
  box-shadow: 0 12px 36px rgba(0,0,0,.40);
}

/* Hell-Theme: etwas leichterer Schatten */
html[data-theme="light"] .items .item.card:hover,
html[data-theme="light"] .items .item.card:focus-within{
  box-shadow: 0 12px 36px rgba(0,0,0,.25);
}

/* Bewegungsreduktion respektieren */
@media (prefers-reduced-motion: reduce){
  .items .item.card{
    transition: none;
  }
}

/* === Notebook: differenzierte Button-Styles === */
/* Notizbuch-Buttons (größer, markanter) */

.nb-col .list-row .nb-btn .ico{
  margin-right:8px; opacity:.9;
}

.nb-col .list-row .sec-btn .ico{
  margin-right:8px; opacity:.9;
}

/* Notizbuch-Buttons (Spalte 1) */
#nbTree .list-row .nb-btn{
  border-radius:16px;
  padding:14px 16px;
  font-weight:600;
}
#nbTree .list-row .nb-btn .ico{
  margin-right:8px; opacity:.9;
}

/* Abschnitt-Buttons (Spalte 1, eingerückt) */
#nbTree .list-row .sec-btn{
  border-radius:12px;
  padding:12px 14px;
  font-weight:500;
}
#nbTree .list-row .sec-btn .ico{
  margin-right:8px; opacity:.9;
}

/* Seiten-Buttons (Spalte 2): linker Farbstreifen */
#pageList .list-row .page-btn{
  position:relative;
  border-radius:12px;
  padding-left:16px; /* platz für den streifen */
}
#pageList .list-row .page-btn::before{
  content:"";
  position:absolute;
  left:0; top:8px; bottom:8px;
  width:4px;
  border-radius:4px;
  background: var(--page-stripe, var(--accent));
}

/* --- Notebook: Click-Pulse für List-Buttons --- */
.list-btn.pulse {
  animation: nbPulse .18s ease-out both;
}

@keyframes nbPulse {
  0%   { transform: scale(.96); }
  60%  { transform: scale(1.02); }
  100% { transform: scale(1); }
}

/* Inline-Rename: Input soll die komplette Button-Fläche abdecken */
.list-btn.renaming { padding: 0 !important; }
.list-btn.renaming .inline-rename{
  display: block;
  width: 100%;
  background: transparent;
  color: inherit;
  border: 0;
  outline: none;
  /* nimm das normale Button-Padding hierher, damit sich optisch nichts ändert */
  padding: 14px 16px;
  font: inherit;
  text-align: left;
  border-radius: inherit;
}

/* Volles Ersatzfeld während des Inline-Rename (ersetzt den Button 1:1) */
.rename-field{
  display:block;
  width:100%;
  background: transparent;
  color: inherit;
  border: 0;
  outline: none;
  padding: 14px 16px;       /* wie deine list-btn */
  font: inherit;
  text-align: left;
  border-radius: inherit;
}

/* Geöffnetes Notizbuch farblich hervorheben */
#nbTree .list-row .nb-btn.open {
  background: linear-gradient(
    135deg,
    color-mix(in srgb, var(--accent) 20%, #1b1f25),
    color-mix(in srgb, var(--accent-2) 20%, #1b1f25)
  );
  border: 1px solid rgba(255,255,255,0.12);
}
html[data-theme="light"] #nbTree .list-row .nb-btn.open {
  background: linear-gradient(
    135deg,
    color-mix(in srgb, var(--accent) 25%, #f1f4f9),
    color-mix(in srgb, var(--accent-2) 25%, #f1f4f9)
  );
  border-color: rgba(0,0,0,0.08);
}

:root{
  /* Breite des Textkörpers im Editor – kanns du bei Bedarf anpassen */
  --editor-max-width: 760px;
}

/* „Papier“-Wrapper im Editor */
.editor-paper{
  margin: 10px auto 14px;
  max-width: var(--editor-max-width);
  padding: 16px 16px;
  border-radius: var(--radius);
  background:
    linear-gradient(rgb(var(--glass-rgb) / calc(var(--card-alpha) + .08)), rgb(var(--glass-rgb) / calc(var(--card-alpha) + .08))) padding-box,
    linear-gradient(135deg, color-mix(in srgb, var(--accent) 30%, transparent), color-mix(in srgb, var(--accent-2) 30%, transparent)) border-box;
  border: 1px solid rgba(255,255,255,.06);
  transition: box-shadow .18s ease, transform .18s ease, background .18s ease;
}
html[data-theme="light"] .editor-paper{
  border-color: rgba(0,0,0,.06);
}

/* Sanfte Fokus-Animation: wenn der Editor Fokus hat */
.content.nb-col:focus-within .editor-paper{
  transform: translateY(-1px);
  box-shadow: 0 16px 42px rgba(0,0,0,.35);
}

/* Save-Status (rechts im Header) dezenter */
#saveStatus{ font-size: 12px; opacity: .9; }

/* Ersatzfeld für echtes Inline-Rename (Button wird temporär ersetzt) */
.rename-field{
  display:block;
  width:100%;
  background: transparent;
  color: inherit;
  border: 0;
  outline: none;
  padding: 14px 16px;
  font: inherit;
  text-align: left;
  border-radius: inherit;
}

/* === Notebook: weißes Editor-Fenster mit Titel/Datum wie OneNote === */

/* dunkles/helles Thema: Editor bleibt bewusst weiß/schwarz */
html[data-theme="dark"] .content.nb-col,
html[data-theme="light"] .content.nb-col{
  background: #fff !important;
  color: #000;
}

/* === Notebook: volle Breite links, contenteditable statt Textarea === */

/* rechte Spalte bleibt voll weiß, aber mit normalem Seitenpadding */
.content.nb-col{
  background: #ffffff !important;
  color: #000000;
  padding: 20px 24px; /* links/rechts etwas Luft */
}

/* Editor-Container nicht zentrieren, volle Breite nutzen */
.editor-sheet{
  max-width: 100%;
  margin: 0;
  padding: 8px 0 18px;
  background: #ffffff;
  color: #000;
  flex: 1;
  display: flex;
  flex-direction: column;
  display: flex;             /* NEU */
  flex-direction: column;    /* NEU */
  min-height: 0;             /* NEU: nötig, damit .editor-body scrollen darf */
}

/* Titel bleibt einfach links */
.editor-title{
  width: 100%;
  font-family: Calibri, "Segoe UI", Arial, sans-serif;
  font-size: 28px;
  font-weight: 600;
  line-height: 1.2;
  color: #000;
  background: transparent;
  border: 0;
  border-bottom: 2px solid #e5e7eb;  /* Unterlinie wie OneNote */
  outline: none;
  padding: 8px 0;
}

/* Datum/Meta direkt unter dem Titel */
.editor-meta{
  margin-top: 6px;
  font-size: 12px;
  color: #6b7280;
}

/* Schreibfläche: contenteditable – ohne Box, mit echten Zeilenumbrüchen */
.editor-body{
  /* Höhe nicht erzwingen – die Flex-Logik übernimmt das */
  width: 100%;
  font-family: Calibri, "Segoe UI", Arial, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  color: #000;
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  outline: none;
  padding-top: 12px;

  /* NEU/Ändert: eigenes Scrolling im Editor */
  flex: 1;
  min-height: 0;             /* WICHTIG: zusammen mit flex-Parent erlaubt Scrollbar */
  overflow-y: auto;          /* Scrollbar in der Schreibfläche */
  resize: none;              /* Resize-Griff unten rechts AUS */

  /* Zeilenumbrüche wie in Editoren/Word */
  white-space: pre-wrap;
  overflow-wrap: anywhere;
}



/* Platzhalter für leeren contenteditable */
.editor-body:empty:before{
  content: attr(data-placeholder);
  color: #9aa1ae;
  pointer-events: none;
}

/* Sicherheit: alte Textarea-Styles nicht greifen lassen, falls das Element doch textarea wäre */
textarea.editor-body{
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
}

#nbBackupSegment .seg-btn{ cursor: pointer; }
#nbBackupSegment .seg-btn.active{ background: linear-gradient(180deg, var(--accent-2), var(--accent)); color: var(--ink-inverse); }

/* === Status-Modal (Erfolg) === */
.status-wrap{
  display:flex; align-items:center; gap:14px;
}
.status-icon{
  width:54px; height:54px; border-radius:999px;
  display:grid; place-items:center;
  background: color-mix(in srgb, var(--success) 22%, transparent);
  color: var(--success);
  font-size: 26px; font-weight: 900;
  box-shadow: inset 0 0 0 2px color-mix(in srgb, var(--success) 45%, transparent);
}
.status-title{
  margin:0; font-size: 22px; line-height:1.2;
}
.status-subtitle{
  margin:6px 0 0; font-size: 14px; opacity:.9;
}

/* === Modal Buttons: Hover/Press + Ripple === */
.modal .btn,
.modal .pressable{
  position: relative;
  overflow: hidden;              /* für den Ripple */
  transition: transform .08s ease, filter .18s ease, box-shadow .18s ease, background-color .18s ease;
  will-change: transform, box-shadow;
}

.modal .btn:hover,
.modal .pressable:hover{
  transform: translateY(-1px);
  box-shadow: 0 8px 24px rgba(0,0,0,.22);
  filter: brightness(1.03);
}

html[data-theme="light"] .modal .btn:hover,
html[data-theme="light"] .modal .pressable:hover{
  box-shadow: 0 8px 20px rgba(0,0,0,.12);
}

.modal .btn:active,
.modal .pressable:active{
  transform: translateY(1px) scale(.98);
  filter: brightness(.98);
  box-shadow: 0 4px 12px rgba(0,0,0,.18);
}

/* Tastaturfokus sichtbar */
.modal .btn:focus-visible,
.modal .pressable:focus-visible{
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* Ripple-Element (per JS hinzugefügt) */
.modal .ripple{
  position: absolute;
  border-radius: 999px;
  transform: scale(0);
  animation: rippleAnim .6s ease-out forwards;
  background: currentColor;
  opacity: .22;                  /* dezenter */
  pointer-events: none;
  mix-blend-mode: multiply;
}
@keyframes rippleAnim{
  to{ transform: scale(16); opacity: 0; }
}

/* === Modal: Ein-/Ausblend-Animation (fixiert, ohne Springen) === */

/* Safety: Dialog immer exakt zentrieren (falls Basis-Rule fehlt/überschrieben wurde) */
.modal .modal-dialog{
  will-change: transform, opacity;
  /* ACHTUNG: Nur setzen, wenn du diese Eigenschaften nicht schon global definierst.
     Falls du bereits in style.css (weiter oben) .modal-dialog mit position/left/top/transform definiert hast,
     kannst du die nächsten vier Zeilen weglassen. */
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%); /* Basis-Zentrierung bleibt IMMER erhalten */
}

/* Beim Öffnen: subtil von leicht oberhalb in die Mitte fahren, ohne die Basis zu verlieren */
.modal.open .modal-dialog{
  animation: modalInCentered .22s cubic-bezier(.22,1,.36,1);
}

/* Beim Schließen: kurz zurück, weich ausfaden */
.modal.closing .modal-dialog{
  animation: modalOutCentered .16s ease-in forwards;
}

@keyframes modalInCentered{
  from{
    opacity: 0;
    transform: translate(-50%, calc(-50% - 6px)) scale(.985); /* relativ zur Mitte */
    filter: blur(1px);
  }
  to{
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
    filter: none;
  }
}

@keyframes modalOutCentered{
  from{
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
    filter: none;
  }
  to{
    opacity: 0;
    transform: translate(-50%, calc(-50% - 4px)) scale(.985);
    filter: blur(.5px);
  }
}

/* In-Animation (appear) */
@keyframes editorIn {
  from{
    opacity: 0;
    transform: translateY(8px) scale(.985);
    filter: blur(1px);
  }
  to{
    opacity: 1;
    transform: none;
    filter: none;
  }
}
.editor-anim-in{
  animation: editorIn .22s cubic-bezier(.22,1,.36,1) both;
}

/* Out-Animation (disappear) */
@keyframes editorOut {
  from{
    opacity: 1;
    transform: none;
    filter: none;
  }
  to{
    opacity: 0;
    transform: translateY(-4px) scale(.985);
    filter: blur(.5px);
  }
}
.editor-anim-out{
  animation: editorOut .16s ease-in both;
}

/* Empty State sanft ein-/ausblenden */
@keyframes fadeInUp {
  from{ opacity: 0; transform: translateY(6px); filter: blur(1px); }
  to  { opacity: 1; transform: none;        filter: none; }
}
@keyframes fadeOutUp {
  from{ opacity: 1; transform: none; filter: none; }
  to  { opacity: 0; transform: translateY(-4px); filter: blur(.5px); }
}
.empty-anim-in{  animation: fadeInUp .20s cubic-bezier(.22,1,.36,1) both; }
.empty-anim-out{ animation: fadeOutUp .12s ease-in both; }

/* Bewegungsreduktion respektieren */
@media (prefers-reduced-motion: reduce){
  .editor-anim-in, .editor-anim-out,
  .empty-anim-in, .empty-anim-out{
    animation-duration: .01s !important;
    animation-timing-function: linear !important;
    filter: none !important;
    transform: none !important;
  }
}

/* === Editor: Zeilenumbrüche sichtbar erzwingen (hohe Spezifität) === */
#pageContent.editor-body{
  white-space: pre-wrap !important;  /* \n bleiben sichtbar */
  overflow-wrap: anywhere;           /* lange Wörter/URLs umbrechen */
}

/* === Bucket: Sidebar Smooth Open/Close === */

/* Basis: Sidebar-Breite wird animiert */
.sidebar{
  width: var(--sidebar-w);                 /* Standardbreite aus Prefs */
  transition: width .22s cubic-bezier(.22,1,.36,1);
  overflow: hidden;                        /* Inhalt nicht herausragen lassen beim Schließen */
}

/* Inhalt in der Sidebar leicht faden (vermeidet Text-"Zuckeln") */
.sidebar > *{
  opacity: 1;
  transition: opacity .16s ease;
}
body.sidebar-collapsed .sidebar > *{
  opacity: 0;
  pointer-events: none;
}

/* Vertikaler Resizer sanft ausblenden/deaktivieren */
#sidebarResizer{
  transition: opacity .16s ease;
}
body.sidebar-collapsed #sidebarResizer{
  opacity: 0;
  pointer-events: none;
}

/* Collapsed-State: Sidebar-Breite = 0 (animiert via transition oben) */
body.sidebar-collapsed .sidebar{
  width: 0px;
}

/* Inhalt (main) füllt automatisch – keine harte Verschiebung nötig.
   Falls du ein explizites Padding/Gap animieren willst, füge hier weitere Transitions hinzu. */

/* Motion-Preference respektieren */
@media (prefers-reduced-motion: reduce){
  .sidebar{ transition: none !important; }
  .sidebar > *{ transition: none !important; }
  #sidebarResizer{ transition: none !important; }
}

/* === Ribbon / Menüband unter der Topbar === */
.ribbon{
  margin: 0 18px 14px 18px;
  padding: 10px 12px;
  border-radius: 12px;
  backdrop-filter: blur(8px);
}
.ribbon-inner{
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}
.ribbon-group{
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.ribbon-divider{
  width: 1px;
  height: 28px;
  background: color-mix(in srgb, var(--ink) 18%, transparent);
  margin: 0 4px;
}

.ff-label{
  font-size: 12px;
  opacity: .8;
}
.ff-select{
  height: 34px;
  min-width: 180px;
  padding: 4px 10px;
  border-radius: 10px;
  border: 1px solid color-mix(in srgb, var(--ink) 18%, transparent);
  background: color-mix(in srgb, #fff 80%, var(--card) 20%);
  font: 14px/1.2 Calibri, "Segoe UI", Arial, sans-serif;
}
.ff-select option[value="Calibri"]{ font-family: Calibri, "Segoe UI", Arial, sans-serif; }
.ff-select option[value="Arial"]{ font-family: Arial, Helvetica, sans-serif; }
.ff-select option[value="Times New Roman"]{ font-family: "Times New Roman", Times, serif; }
.ff-select option[value="Consolas"]{ font-family: Consolas, "Courier New", monospace; }
.ff-select option[value="Courier New"]{ font-family: "Courier New", monospace; }
.ff-select option[value="Verdana"]{ font-family: Verdana, Geneva, Tahoma, sans-serif; }

/* Ribbon Buttons (nutzen deine Pressable-Optik + Active-State) */
.rbtn{
  position: relative;
  height: 36px;
  min-width: 36px;
  padding: 0 12px;
  border-radius: 10px;
  border: 1px solid color-mix(in srgb, var(--ink) 18%, transparent);
  background: color-mix(in srgb, #fff 75%, var(--card) 25%);
  font-weight: 700;
  letter-spacing: .4px;
  transition: transform .08s ease, filter .18s ease, box-shadow .18s ease, background-color .18s ease;
}
.rbtn:hover{ transform: translateY(-1px); box-shadow: 0 8px 24px rgba(0,0,0,.18); }
.rbtn:active{ transform: translateY(1px) scale(.98); }
.rbtn[aria-pressed="true"]{
  background: linear-gradient(180deg, var(--accent-2), var(--accent));
  color: var(--ink-inverse);
  border-color: transparent;
}

@media (prefers-reduced-motion: reduce){
  .rbtn{ transition: none; }
}

.pill-btn{
  display: inline-flex;
  align-items: center;
  gap: 8px;

  padding: 8px 14px;
  border-radius: 999px;
  border: 2px solid var(--accent);
  background: color-mix(in srgb, #fff 92%, var(--card) 8%);
  color: var(--ink);
  font-weight: 700;
  letter-spacing: .2px;

  transition: transform .08s ease, box-shadow .18s ease, background-color .18s ease, border-color .18s ease;
}

/* Nur schlichtes Plus – KEIN umkreistes Plus mehr */
.pill-btn .plus{
  border: none;              /* <— Umkreisung aus */
  width: auto;
  height: auto;
  line-height: 1;
  font-weight: 900;
  margin-left: 2px;
}

.pill-btn:hover{
  transform: translateY(-1px);
  box-shadow: 0 10px 26px rgba(0,0,0,.14);
  background: color-mix(in srgb, #fff 96%, var(--card) 4%);
  border-color: var(--accent-2);
}
.pill-btn:active{
  transform: translateY(1px) scale(.985);
}

/* Spaltenabstände etwas harmonischer (wie im Screenshot) */
#nbTree{ padding: 10px 10px 6px 10px; }
/* rechte Spalte: etwas mehr Innenabstand, damit Liste sauber sitzt */
#pageList{
  padding: 6px 16px 14px 16px;
}

/* === Notebook: 2-Spalten-Layout (links Panel, rechts Editor) === */
/* === Notebook: 2-Spalten-Layout (links Panel, rechts Editor) === */
.nb-layout{
  display: grid;
  /* 5 Spalten: Sections | Sep | Pages | Sep | Editor */
  grid-template-columns: var(--sidebar-w, 520px) 2px var(--pages-w, 360px) 2px 1fr;
  gap: 18px;
  height: calc(100vh - 120px);
  padding: 0 18px 18px;
}


.nb-layout .content.nb-col{
  display: flex;             /* damit der Editor-Bereich eine Spalte bilden kann */
  flex-direction: column;
  min-height: 0;             /* WICHTIG: erlaubt dem Kind, zu schrumpfen -> Scrollbar greift */
  overflow: hidden;          /* verhindert Durchscheinen des Hintergrunds */
}


/* Gemeinsames Panel (Notizbücher/Abschnitte | Trenner | Seiten) */
.nb-split{
  display: grid;
  grid-template-columns: 1fr 1px 1fr;
  height: 100%;
  border-radius: var(--radius);
  overflow: hidden;
}

/* Innenabstände der linken/rechten Panelhälfte */
.nb-left, .nb-right{ padding: 6px; }

.nb-sep{
  width: 2px;                    /* etwas sichtbarer als 1px */
  margin: 8px 0;                 /* oben/unten Lücke, damit nicht „voll durchgezogen“ */
  background:
    repeating-linear-gradient(
      to bottom,
      color-mix(in srgb, var(--ink) 22%, transparent) 0 10px,  /* Segment */
      transparent 10px 20px                                    /* Lücke */
    );
  border-radius: 999px;
}


/* Seiten-Header kompakt */
.page-top{
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 6px 8px 8px 8px;
  margin: 0 0 8px 0;
}

/* Abstand zwischen Seiten-Karten */
#pageList .list-row{ margin-bottom: 10px; }
#pageList .list-row:last-child{ margin-bottom: 0; }

/* Optional: auch links die Einträge leicht lockern */
#nbTree .list-row{ margin-bottom: 10px; }
#nbTree .list-row:last-child{ margin-bottom: 0; }

/* Rechte Spalte (Editor) — verhindert „Klemmen“/Versatz */
.editor-col{
  min-width: 0;             /* wichtig für Grids: Text darf umbrechen */
  display: block;
}


@media (max-width: 1280px){
  /* Seiten-Spalte etwas schmaler machen */
  :root{ --pages-w: 300px; }
  .nb-layout{
    grid-template-columns: var(--sidebar-w, 440px) 2px var(--pages-w, 300px) 2px 1fr;
  }
}

@media (max-width: 980px){
  /* Unter 980px: untereinander (mobile) */
  .nb-layout{ grid-template-columns: 1fr; }
  /* Trennlinien in Einspaltendarstellung ausblenden (optional) */
  .nb-sep{ display:none; }
}


.nb-col{
  display: flex;
  flex-direction: column;
  height: 100%;
}

/* ==== Notebook-Header (grüne Karte) – Layout & Buttons neu ansetzen ==== */

/* 1) Header-Karte luftiger und umbrechbar, damit eine zweite Zeile für die Actions entstehen kann */
.nb-header,
.nb-notebook,
.nbk-header,
.nbk {                    /* einer dieser Klassen steckt bei dir auf der grünen Karte */
  display: flex;
  flex-wrap: wrap;        /* Buttons können in die nächste Zeile rutschen */
  align-items: flex-start;
  gap: 8px 10px;
  padding: 14px 16px;     /* etwas mehr “Atmung” */
  min-height: 72px;       /* sichtbare Höhe, damit nichts gequetscht wirkt */
}

/* 2) Titel/Name im Header minimal größer/lesbarer */
.nb-header .title,
.nb-notebook .title,
.nbk-header .title,
.nbk .title {
  font-size: 1.06rem;
  line-height: 1.3rem;
  font-weight: 600;
}

/* 3) Actions als eigene Werkzeugleiste in Zeile 2, rechtsbündig */
.nb-header .actions,
.nb-notebook .actions,
.nbk-header .actions,
.nbk .actions {
  order: 2;               /* unterhalb von Icon/Titel */
  width: 100%;            /* volle Breite → eigene Zeile */
  display: flex;
  justify-content: flex-end;
  gap: 8px;               /* Abstand zwischen den Buttons */
  margin-top: 2px;
}

/* 4) Buttons selbst etwas größer/griffiger – ohne übertrieben zu wirken */
.nb-header .actions .icon-btn,
.nb-notebook .actions .icon-btn,
.nbk-header .actions .icon-btn,
.nbk .actions .icon-btn,
.nb-header .actions button,
.nb-notebook .actions button,
.nbk-header .actions button,
.nbk .actions button {
  width: 34px;
  height: 34px;
  border-radius: 999px;
}

/* 5) (Feinschliff) – Wenn die Karte ein Icon links hat, verhindere, dass es die Actions stört */
.nb-header .icon,
.nb-notebook .icon,
.nbk-header .icon,
.nbk .icon {
  flex: 0 0 auto;
}

/* Größeres Settings-Modal (mehr Platz für Optionen) */
.modal-dialog.settings{
  width: min(760px, 92vw);
  max-height: 86vh;
  padding: 18px;
}
.modal-dialog.settings .settings-section{
  margin-bottom: 16px;
}

/* HUD-Overlay für die Live-Vorschau beim Ziehen (kompakt, mittig) */
.slider-hud{
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  border-radius: 12px;
  background: color-mix(in srgb, #fff calc(var(--glass-alpha, .75)*100%), var(--card));
  box-shadow: 0 18px 44px rgba(0,0,0,.25);
  border: 1px solid color-mix(in srgb, var(--ink) 20%, transparent);
}
.slider-hud .value{
  min-width: 84px;
  text-align: right;
  font-weight: 700;
  opacity: .9;
}
.slider-hud input[type="range"]{
  width: min(520px, 74vw);
}

/* === Ribbon: Dark-Mode heller machen (Text/Buttons/Selects) === */
html[data-theme="dark"] .ribbon .ff-label { color: #fff; opacity: .9; }

html[data-theme="dark"] .ribbon .ff-select{
  color: #fff;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.18);
}

html[data-theme="dark"] .ribbon .rbtn{
  color: #fff;
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.2);
}
html[data-theme="dark"] .ribbon .rbtn[aria-pressed="true"]{
  color: var(--ink-inverse);
}

html[data-theme="dark"] .ribbon-divider{
  background: rgba(255,255,255,.15);
}

/* === Kombinierte Topbar (Header + Tools) === */
.topbar-merged .topbar-main{
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  max-width: none;   /* NICHT begrenzen */
  margin: 0;         /* NICHT zentrieren */
  padding: 0;        /* KEIN Innenabstand */
}


.topbar-subdivider-h{
  width: 100%;
  height: 1px;
  background: #d3d4d6;   /* hellgrau, dezent */
  opacity: 0.9;
  margin: 2px 0 4px;     /* wenig Luft über/unter der Linie */
}

.topbar-merged .topbar-main{
  display: flex;
  align-items: center;
  gap: 12px;
}
.topbar-merged .topbar-main .left{
  display: grid;
  grid-template-columns: auto 1fr; /* 1: Back-Button, 2: Titel (nimmt restliche Breite) */
  grid-auto-rows: min-content;
  column-gap: 10px;
  row-gap: 6px;
  align-items: center;
  width: 100%;
}

/* Erste Zeile: Back-Button links, Titel rechts davon */
.topbar-merged .topbar-main .left #backBtn{ grid-column: 1; }
.topbar-merged .topbar-main .left h1{ grid-column: 2; }

/* Linie und Ribbon sollen über die volle Breite gehen (neue Zeile, beide Spalten) */
.topbar-merged .topbar-main .left .topbar-subdivider-h{ grid-column: 1 / -1; }
.topbar-merged .topbar-main .left .ribbon-inner{ grid-column: 1 / -1; }


.topbar-merged .topbar-main .right{
  margin-left: auto;     /* schiebt nach ganz rechts */
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0;            /* kein Innenabstand */
}

.topbar-merged h1{ margin:0; font-size: 22px; }

/* Helle Trennlinie */
.topbar-divider{
  height: 1px;
  background: #b8b9bb;           /* hellgrau */
  border-radius: 999px;
}
html[data-theme="dark"] .topbar-divider{ background: rgba(255,255,255,.20); }

.topbar-tools .ribbon-inner,
.topbar-merged .topbar-main .left .ribbon-inner{
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
  padding: 0;
  justify-content: flex-start;
}
.topbar-merged .ribbon-divider{
  width: 1px; height: 28px;
  background: #a2a3a5;
  margin: 0 6px;
}
html[data-theme="dark"] .topbar-merged .ribbon-divider{ background: rgba(255,255,255,.20); }

/* SVG im Zurück-Button passend einfärben */
.icon-btn svg{ width:18px; height:18px; stroke: currentColor; fill: none; }

/* === Modern Select ======================================================= */
.select-modern{
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;

  display: inline-flex;
  align-items: center;
  gap: .5rem;

  background: rgba(255,255,255,.06); 
  border: 1px solid rgba(255,255,255,.14);
  color: #e6eaf2;

  padding: .55rem 2.25rem .55rem .8rem; /* rechts Platz für Pfeil */
  border-radius: 14px;

  font: inherit;
  line-height: 1.2;

  transition: border-color .18s ease, box-shadow .18s ease, background .18s ease;
  cursor: pointer;
}

/* Hover */
.select-modern:hover{
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.22);
}

/* Fokus – Akzentfarbe deiner App */
.select-modern:focus{
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 30%, transparent);
}

/* Pfeil-Icon als eingebettetes SVG (hell/dunkel passt sich an) */
.select-modern{
  background-image:
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%23cfd6e4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
  background-repeat: no-repeat;
  background-position: right .6rem center;
  background-size: 18px 18px;
}

/* Windows/Edge altes Pfeil-Icon ausblenden */
.select-modern::-ms-expand{ display:none; }

/* Light-Theme-Feinschliff (falls du das data-theme nutzt) */
html[data-theme="light"] .select-modern{
  background: rgba(0,0,0,.03);
  border-color: rgba(0,0,0,.12);
  color: #0f172a;
}
html[data-theme="light"] .select-modern:hover{
  background: rgba(0,0,0,.045);
  border-color: rgba(0,0,0,.18);
}
html[data-theme="light"] .select-modern{
  background-image:
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%230f172a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
}

/* Option-Optik (wird je nach Browser unterschiedlich stark angewendet) */
.select-modern option{
  background: #202a35;
  color: #e6eaf2;
}
html[data-theme="light"] .select-modern option{
  background: #ffffff;
  color: #0f172a;
}

/* === Toast Container (oben rechts) === */
#toast-root {
  position: fixed;
  top: 16px;
  right: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 9999;
}

/* ===== Toast (Export-Erfolg) ===== */
#toastHost{
  position: fixed;
  top: 14px;
  right: 14px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 8px;
  pointer-events: none; /* Host "klickt" nicht in den Flow */
}

/* === Inhalt/Zeilen-Layout im Toast === */
.toast{
  pointer-events: auto; /* Toast selbst ist klickbar */
  display: grid;
  grid-template-columns: 40px 1fr 28px;
  align-items: center;
  gap: 10px;
  min-width: 280px;
  max-width: min(420px, 90vw);
  padding: 12px 12px 8px;
  border-radius: 14px;
  background: color-mix(in srgb, rgb(13, 141, 9) 18%, transparent);
  box-shadow: 0 10px 30px color-mix(in srgb, rgb(13, 141, 9) 30%, transparent);
  border: 1px solid color-mix(in srgb, rgb(13, 141, 9) 35%, transparent);
  backdrop-filter: blur(10px) saturate(1.2);
}

.toast .toast-icon {
  flex: 0 0 auto;
  width: 28px;
  height: 28px;
  display: grid;
  place-items: center;
}

.toast .toast-body {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.toast .toast-title {
  font-weight: 700;
  line-height: 1.2;
}

#settings-icon {
  width: 20px;
  height: 20px;
}

.toast .toast-subtitle {
  opacity: 0.85;
  line-height: 1.2;
  font-size: 0.95em;
}

/* Icon links (großer Haken) */
.toast .ico{
  width: 40px; height: 40px; border-radius: 12px;
  display: grid; place-items: center;
  background: color-mix(in srgb, var(--success) 22%, transparent);
  color: var(--success);
  font-size: 22px; line-height: 1;
}

/* Textblock */
.toast .txt h3{
  margin: 0;
  font-size: 16px;
  font-weight: 800;
}
.toast .txt p{
  margin: 2px 0 0;
  font-size: 13px;
  opacity: .9;
}

/* Close-Button (X) */
.toast .close{
  border: 0; background: transparent; color: inherit; cursor: pointer;
  width: 28px; height: 28px; border-radius: 8px;
  display: grid; place-items: center; font-size: 16px;
}
.toast .close:hover{ background: rgba(255,255,255,.08); }

/* === Close Button (oben rechts im Toast) === */
.toast .toast-close {
  position: absolute;
  top: 8px;
  right: 8px;
  border: none;
  background: transparent;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  opacity: 0.7;
}
.toast .toast-close:hover { opacity: 1; }

/* === Progressbar unten (wir animieren das innere DIV) === */
.toast .progress{
  grid-column: 1 / -1;
  height: 3px;
  width: 100%;
  border-radius: 0 0 12px 12px;
  background: rgba(255,255,255,.08);
  overflow: hidden;
  margin-top: 8px;
}
.toast .progress > .bar {
  width: 100%;
  height: 100%;
  transition: width linear; /* Dauer setzen wir dynamisch per JS */
}

.toast .progress > i{
  display: block;
  height: 100%;
  width: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  transform-origin: left center;
  transform: scaleX(1);
  transition: transform linear;
}

/* Light-Mode kleine Kontraste anpassen */
html[data-theme="light"] .toast{
  border-color: rgba(0,0,0,.08);
  box-shadow: 0 12px 30px rgba(0,0,0,.15);
}
html[data-theme="light"] .toast .ico{
  background: color-mix(in srgb, var(--success) 18%, transparent);
}

/* ===== Komet (To-Do → Archiv) + Impact-Burst ===== */
.fx-comet{
  position: fixed;
  left: 0; top: 0;
  width: 10px; height: 10px;
  border-radius: 999px;
  background: #22c55e; /* Grün */
  box-shadow:
    0 0 0 2px rgba(34,197,94,.22),
    0 0 22px rgba(34,197,94,.65),
    0 0 44px rgba(34,197,94,.35);
  pointer-events: none;
  z-index: 99999;
  transform: translate3d(0,0,0);
  transition: transform 680ms cubic-bezier(.22,1,.36,1);
}

/* kleiner Schweif (optisch „Linie“) */
.fx-comet::after{
  content: "";
  position: absolute;
  right: 50%;
  top: 50%;
  width: 120px; height: 2px;
  transform: translateY(-50%);
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(34,197,94,.0), rgba(34,197,94,.8));
  filter: blur(0.3px);
}

/* Vollbild-Burst beim Aufprall */
.fx-burst{
  position: fixed; inset: 0;
  pointer-events: none;
  z-index: 99999;
  overflow: visible;
}
.fx-burst .emitter{
  position: absolute;
  left: 0; top: 0;
  transform: translate3d(var(--x,0), var(--y,0), 0);
}
.fx-burst i{
  position: absolute;
  left: 0; top: 0;
  width: 8px; height: 8px;
  border-radius: 2px;
  background: #22c55e;
  opacity: 0;
  animation: burstFly 800ms ease-out forwards;
}

@keyframes burstFly{
  0%   { opacity: 1; transform: translate3d(0,0,0) scale(.9) rotate(0deg); }
  100% {
    opacity: 0;
    transform:
      translate3d(var(--tx,0), var(--ty,0), 0)
      scale(1) rotate(var(--rot,0deg));
  }
}

/* Rename-Modal: Feld wie Titel mit Akzent-Linie */
#renameInput{
  background: transparent;
  border: 0;
  border-bottom: 1px solid #5c6169;
  padding: 10px 4px;
  color: var(--ink);
  transition: border-color .2s ease;
}
#renameInput:focus,
#renameInput:focus-visible{
  outline: none;
  border-bottom-color: var(--accent);
}
html[data-theme="light"] #renameInput{ border-bottom-color:#c2c9d6; }

/* === CTA: + Neue Liste / + Neuer Eintrag === */
#addListBtn,
#addItemBtn{
  transform-origin: 50% 50%;

}

/* Hover: leicht anheben + Glow, ohne große Skalierung */
#addListBtn:hover,
#addItemBtn:hover{
  transform: translateY(-2px) scale(1.015);
  filter: brightness(1.06);
  box-shadow: 0 14px 36px rgba(0,0,0,.35);
}

/* Press (gedrückt halten): minimal kleiner – Release triggert .pop in JS */
#addListBtn:active,
#addItemBtn:active{
  transform: translateY(0) scale(.965);
  box-shadow: 0 8px 22px rgba(0,0,0,.30);
}

/* === Danger Button (Archiv leeren) === */
.btn.btn-danger{
  background: linear-gradient(180deg, #e63946, #b92d38);
  color: #fff;
  border: none;
  border-radius: 13px;
  padding: 10px 20px;
  font-weight: 600;
  letter-spacing: .3px;
  -webkit-backdrop-filter: blur(8px) saturate(1.1);
  backdrop-filter: blur(8px) saturate(1.1);
  box-shadow: 0 6px 18px rgba(230,57,70,.45);
  transition: transform var(--press-dur) cubic-bezier(.22,1,.36,1),
              box-shadow var(--press-dur) ease,
              filter var(--press-dur) ease;
}

.btn.btn-danger:hover{
  transform: translateY(-2px) scale(1.02);
  filter: brightness(1.08);
  box-shadow: 0 12px 28px rgba(230,57,70,.55);
}

.btn.btn-danger:active{
  transform: scale(.96);
  box-shadow: 0 6px 18px rgba(185,45,56,.55);
}

/* === Listenzeile: optionales Icon vor dem Namen === */
.list-btn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
}

.list-btn .list-ico{
  width: 18px;
  height: 18px;
  object-fit: contain;
  flex: 0 0 auto;
  opacity: 0.95;
  filter: drop-shadow(0 0 0 rgba(0,0,0,0));
}
html[data-theme="light"] .list-btn .list-ico{
  opacity: 0.9;
}

/* === Icon-Auswahlraster für "Neue Liste"-Modal === */
.icon-grid{
  display: grid;
  grid-template-columns: repeat(5, 48px);
  gap: 10px;
  margin-top: 6px;
}

.icon-tile{
  display: grid;
  place-items: center;
  width: 48px;
  height: 48px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.12);
  background: #1b1f25;
  cursor: pointer;
  transition: transform .12s ease, filter .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.icon-tile img{
  width: 22px;
  height: 22px;
}

.icon-tile:hover{
  transform: translateY(-1px);
  filter: brightness(1.05);
}
.icon-tile[aria-pressed="true"]{
  outline: 2px solid var(--accent);
  background: #0e1117;
  box-shadow: 0 6px 18px rgba(0,0,0,.28);
}
html[data-theme="light"] .icon-tile{
  background: #f1f4f9;
  border-color: rgba(0,0,0,.06);
}
html[data-theme="light"] .icon-tile[aria-pressed="true"]{
  background: #fff;
}

/* ===== Profile Badge in der Topbar ===== */
.profile-badge{
  display:flex; align-items:center; gap:8px;
  padding:6px 8px; border-radius:12px;
  background: rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.12);
}
html[data-theme="light"] .profile-badge{
  background:#eef1f6; border-color: rgba(0,0,0,.06);
}
.profile-badge img{
  width:24px; height:24px; border-radius:50%; object-fit:cover;
}

/* Vorschau im Profil-Modal */
.avatar-preview{
  width:48px; height:48px; border-radius:50%; object-fit:cover;
  background:#2b2f35; border:1px solid rgba(255,255,255,.12);
}
html[data-theme="light"] .avatar-preview{
  background:#eef1f6; border-color: rgba(0,0,0,.12);
}

/* === Floating Fields (Profil-Modal) ===================================== */
.ff{
  position: relative;
  margin: 14px 0;
}

.ff input{
  width: 100%;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.06);
  color: var(--ink);
  border-radius: 12px;
  padding: 14px 12px 12px;
  font: inherit;
  line-height: 1.2;
  outline: none;
  transition:
    border-color .18s ease,
    box-shadow .18s ease,
    background-color .18s ease;
}

html[data-theme="light"] .ff input{
  background: #eef1f6;
  border-color: rgba(0,0,0,.12);
  color: #0b1220;
}

/* Fokuszustand: Akzentfarbe + sanfter Glow */
.ff input:focus{
  border-color: var(--accent);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 30%, transparent);
}

/* Label: schwebt bei Fokus/Value nach oben */
.ff label{
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
  color: #b9c0c9;
  transition:
    transform .16s cubic-bezier(.22,1,.36,1),
    color .16s ease,
    background-color .16s ease,
    top .16s ease;
  padding: 0 6px;
  background: transparent; /* füllt sich nur im gefloateten Zustand */
}

html[data-theme="light"] .ff label{ color: #536072; }

/* Zustand „float“: kleiner, oben im Rand */
.ff input:focus + label,
.ff.has-value label,
.ff input:not(:placeholder-shown) + label{
  top: 0;
  transform: translateY(-50%) scale(.88);
  color: var(--accent);
  background:
    linear-gradient(
      to bottom,
      color-mix(in srgb, var(--bg) 100%, transparent) 0 40%,
      transparent 40% 60%,
      color-mix(in srgb, var(--bg) 100%, transparent) 60% 100%
    );
  /* sorgt dafür, dass das Label lesbar „im Rand“ sitzt */
}

/* Light: Hintergrund hinter dem gefloateten Label an das helle Modal anpassen */
html[data-theme="light"] .ff input:focus + label,
html[data-theme="light"] .ff.has-value label,
html[data-theme="light"] .ff input:not(:placeholder-shown) + label{
  background:
    linear-gradient(
      to bottom,
      #fff 0 40%,
      transparent 40% 60%,
      #fff 60% 100%
    );
}

/* Kleinere Feinschliffe */
.ff input::placeholder{ color: transparent; } /* wir zeigen den Platzhalter nicht — Label übernimmt */
.ff input:focus::placeholder{ color: transparent; }

/* === Modal Title mit Icon (Profil) ===================== */
.modal-title-with-icon{
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.modal-title-with-icon h2{
  margin: 0;
  font-size: 28px;
  font-weight: 700;
  color: var(--ink);
}

.modal-title-icon{
  width: 56px;
  height: 56px;
  object-fit: contain;
  opacity: 0.9;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.25));
  transition: transform .18s ease, filter .18s ease;
}

/* Back-Pfeil im Einstellungs-Hauptmenü ausblenden */
#settingsModal[data-view="menu"] #settingsBackBtn{
  display: none !important;
}


.modal-title-icon:hover{
  transform: scale(1.05);
  filter: drop-shadow(0 2px 4px rgba(0,0,0,.35));
}

html[data-theme="light"] .modal-title-icon{
  opacity: 0.85;
}

/* === Settings: Menü-Ebene (Design / Sonstiges) === */
.settings-menu{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 12px;
  margin: 8px 0 14px;
}

.menu-card{
  display: grid;
  align-content: center;
  gap: 6px;
  text-align: left;
  padding: 14px 16px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgb(var(--glass-rgb) / var(--glass-strong-alpha));
  color: var(--ink);
  cursor: pointer;
  transition: transform .12s ease, filter .18s ease, box-shadow .18s ease;
}
.menu-card:hover{ transform: translateY(-1px); filter: brightness(1.03); box-shadow: 0 12px 26px rgba(0,0,0,.22); }
.menu-card:active{ transform: translateY(0) scale(.985); }

.menu-card-title{ font-weight: 700; font-size: 16px; }
.menu-card-sub{ font-size: 13px; opacity: .85; }

/* Icon neben dem Kartentitel (Einstellungen-Menü) */
.menu-card-title{
  display: inline-flex;
  align-items: center;
  gap: 8px;               /* Abstand Icon–Text */
}

.menu-card-ico{
  width: 18px;
  height: 18px;
  flex: 0 0 auto;
  object-fit: contain;
  opacity: .95;
  filter: drop-shadow(0 0 0 rgba(0,0,0,0)); /* sauber/neutral */
}

/* Light-Theme leichte Anpassung */
html[data-theme="light"] .menu-card-ico{
  opacity: .9;
}


html[data-theme="light"] .menu-card{
  background:#fff; color:#0b1220; border-color: rgba(0,0,0,.08);
}

/* === Scrollbar erst bei Bedarf anzeigen (automatisch) === */

/* Für die gesamte Seite */
html, body {
  overflow-y: auto;         /* Zeigt Scrollbar nur, wenn nötig */
  scrollbar-gutter: stable; /* optional: verhindert Layout-Sprung */
}

/* Für Hauptbereiche mit eigenem Overflow (z. B. Sidebar, Content, Modals etc.) */
.sidebar,
.content,
.modal-dialog,
.drawer-panel {
  overflow-y: auto;
  scrollbar-width: thin;    /* schmal (Firefox) */
}

/* Scrollbars standardmäßig unsichtbar, erst beim Scrollen sichtbar (WebKit) */
::-webkit-scrollbar {
  width: 8px;
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.25);
  border-radius: 8px;
}
::-webkit-scrollbar-thumb:hover {
  background: rgba(255,255,255,0.35);
}

/* ==== Unteraufgaben (Modal + Listen-Vorschau) ==== */
.subtasks-list {
  display: grid;
  gap: 8px;
  margin-top: 6px;
}
.subtask-row {
  display: grid;
  grid-template-columns: 24px 1fr auto;
  align-items: center;
  gap: 8px;
  background: color-mix(in srgb, var(--fg) 8%, transparent);
  padding: 8px 10px;
  border-radius: 10px;
}
.subtask-row input[type="checkbox"] {
  width: 18px;
  height: 18px;
}
.subtask-input {
  width: 100%;
  border: none;
  outline: none;
  background: transparent;
  font: inherit;
  padding: 6px 8px;
  border-radius: 8px;
}
.subtask-row .subtask-remove {
  border: none;
  background: transparent;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
  opacity: .7;
}
.subtask-row .subtask-remove:hover { opacity: 1; }

/* Vorschau in der Item-Karte */
.subtasks-preview {
  list-style: none;
  padding: 6px 0 0 0;
  margin: 0;
  display: grid;
  gap: 4px;
}
.subtasks-preview li {
  display: grid;
  grid-template-columns: 18px 1fr;
  gap: 8px;
  align-items: center;
  font-size: .95rem;
  opacity: .9;
}
.subtasks-preview li.done { opacity: .55; text-decoration: line-through; }
.subtasks-preview input[type="checkbox"] { width: 16px; height: 16px; }

/* "Button" wie Link in Akzentfarbe darstellen */
.subtask-add-link {
  background: transparent;
  border: 0;
  padding: 0;
  margin: 6px 0 0;
  color: var(--accent);
  font: inherit;
  font-weight: 700;
  cursor: pointer;
  display: inline-block;
  transition: filter 0.15s ease;
}

/* Hover ohne Linie, aber etwas heller */
.subtask-add-link:hover {
  text-decoration: none;
  filter: brightness(1.2);
}

/* Fokus sichtbar, aber ohne Linie */
.subtask-add-link:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* === Unteraufgaben: helles, sauberes Styling === */

/* Wrapper der Unteraufgabe */
.subtask-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 6px 0;
  padding: 6px 0;
  color: var(--ink); /* heller Text */
}

/* Checkbox modern, rund, in Akzentfarbe */
.subtask-row .subtask-done {
  appearance: none;
  width: 18px;
  height: 18px;
  border: 2px solid color-mix(in srgb, var(--accent) 45%, #888);
  border-radius: 5px;
  background: transparent;
  cursor: pointer;
  position: relative;
  transition: all 0.18s ease;
}

/* aktiver Zustand: gefüllt mit Akzentfarbe + Haken */
.subtask-row .subtask-done:checked {
  background: var(--accent);
  border-color: var(--accent);
}
.subtask-row .subtask-done:checked::after {
  content: "";
  position: absolute;
  left: 4px;
  top: 1px;
  width: 5px;
  height: 9px;
  border: solid var(--ink-inverse);
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Textfeld */
.subtask-row .subtask-input {
  flex: 1;
  background: transparent;
  border: 0;
  border-bottom: 1px solid rgba(255,255,255,.15);
  color: var(--ink);
  padding: 4px 2px;
  outline: none;
  transition: border-color .18s ease;
}
.subtask-row .subtask-input:focus {
  border-color: var(--accent);
}

/* Entfernen-Button (X) hell, dezent, aber klickbar */
.subtask-row .subtask-remove {
  background: transparent;
  border: 0;
  color: var(--ink);
  opacity: 0.7;
  font-size: 16px;
  cursor: pointer;
  transition: opacity .18s ease, transform .1s ease;
}
.subtask-row .subtask-remove:hover {
  opacity: 1;
  transform: scale(1.1);
}
.subtask-row .subtask-remove:active {
  transform: scale(0.9);
}

/* Hellmodus anpassen */
html[data-theme="light"] .subtask-row {
  color: #0b1220;
}
html[data-theme="light"] .subtask-row .subtask-done {
  border-color: color-mix(in srgb, var(--accent) 55%, #555);
}
html[data-theme="light"] .subtask-row .subtask-done:checked::after {
  border-color: #fff;
}

/* === Subtasks in Karten – kompakt & sauber === */
.items .item .subtasks-preview{
  margin-top: 6px;
  padding: 8px 10px;
  border-radius: 10px;
  background: rgba(255,255,255,0.035);          /* dezente Fläche */
  border: 1px solid rgba(255,255,255,0.06);
  display: grid;
  gap: 6px;
  max-height: 120px;                             /* verhindert überlange Karten */
  overflow: auto;                                /* innerhalb der Box scrollen */
}

/* einzelne Zeile */
.items .item .subtasks-preview li{
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 6px 8px;
  border-radius: 8px;
  background: rgba(255,255,255,0.02);
}

/* Checkbox stilisieren (ohne Markup-Änderung) */
.items .item .subtasks-preview li input[type="checkbox"]{
  appearance: none;
  width: 16px;
  height: 16px;
  border-radius: 4px;
  border: 2px solid var(--accent);
  background: transparent;
  display: inline-grid;
  place-items: center;
  cursor: pointer;
  transition: background-color .18s ease, border-color .18s ease, transform .08s ease;
}
.items .item .subtasks-preview li input[type="checkbox"]:active{
  transform: scale(.95);
}
.items .item .subtasks-preview li input[type="checkbox"]:checked{
  background: var(--accent);
  border-color: var(--accent);
}
.items .item .subtasks-preview li input[type="checkbox"]:checked::after{
  content: "";
  width: 8px;
  height: 8px;
  transform: rotate(45deg);
  border-right: 2px solid rgba(0,0,0,.85);
  border-bottom: 2px solid rgba(0,0,0,.85);
  margin-top: -1px;
}

/* Text */
.items .item .subtasks-preview li span{
  font-size: .92rem;
  line-height: 1.25;
  opacity: .95;
  word-break: break-word;
}

/* Erledigt-Style aus JS (.done) übernehmen */
.items .item .subtasks-preview li.done{
  opacity: .75;
  background: rgba(255,255,255,0.03);
}
.items .item .subtasks-preview li.done span{
  text-decoration: line-through;
  opacity: .8;
}

/* schlanke Scrollbar in der Vorschaubox */
.items .item .subtasks-preview{
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.25) transparent;
}
.items .item .subtasks-preview::-webkit-scrollbar{
  height: 8px;
  width: 8px;
}
.items .item .subtasks-preview::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.25);
  border-radius: 8px;
}
.items .item .subtasks-preview::-webkit-scrollbar-track{
  background: transparent;
}

/* === Version-Ansicht (Einstellungen) === */
.version-view{
  display: grid;
  justify-items: center;
  gap: 10px;
  padding: 24px;
  border-radius: var(--radius);
  background: rgb(var(--glass-rgb) / var(--glass-strong-alpha));
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: var(--shadow);
  text-align: center;
}

.version-view .version-logo{
  width: min(220px, 60vw);
  height: auto;
  object-fit: contain;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,.35));
}

.version-view .version-title{
  margin: 8px 0 0;
  font-size: 24px;
  line-height: 1.2;
}

.version-view .version-string{
  margin: 6px 0 0;
  font-size: 14px;
  opacity: .9;
  color: var(--muted);
}

/* Light-Mode Feinschliff */
html[data-theme="light"] .version-view{
  background: #fff;
  border-color: rgba(0,0,0,.08);
  box-shadow: 0 12px 30px rgba(0,0,0,.12);
}

